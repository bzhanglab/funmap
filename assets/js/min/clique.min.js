function clique_page(a){function b(o,p="clique.json"){let q="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(o));let r=document.createElement("a");r.setAttribute("href",q);r.setAttribute("download",p);document.body.appendChild(r);r.click();r.remove()}function c(s){return!isNaN(parseInt(s))&&isFinite(s)}function d(t){return!isNaN(parseFloat(t))&&isFinite(t)}function e(u){let v=document.createElement("table");let w=document.createElement("thead");let x=document.createElement("tbody");let y=document.createElement("tr");for(let z=0;z<u["rows"].length;z++){let A=document.createElement("th");let B=u["rows"][z];if(B=="Hazard Ratio"){B='<abbr title="Explanation of Hazard Ratio">Hazard Ratio</abbr>'}A.innerHTML=B;y.appendChild(A)}w.appendChild(y);v.appendChild(w);for(let C=0;C<u["data"].length;C++){let D=document.createElement("tr");for(let E=0;E<u["data"][C].length;E++){let F=document.createElement("td");let G=u["data"][C][E];if(d(G)){G=parseFloat(G);if(G==0){G="< 2.20e-16"}else if(Math.abs(G)>.001&&Math.abs(G)<1e3){G=G.toPrecision(3)}else{G=G.toExponential(2)}}else if(G==null){G="Not Available"}F.innerHTML=G;D.appendChild(F)}x.appendChild(D)}v.appendChild(x);return v}let f=document.getElementById("gene_search_error");let g=document.getElementById("clique_search_error");let h="../data/clique_genes.json";let i="genes";let j="../data/gene_to_clique.json";fetch(j).then(H=>H.json()).then(I=>{j=I});fetch(h).then(J=>J.json()).then(K=>{let L=document.getElementById(i);for(let M=0;M<K.length;M++){let N=document.createElement("option");N.value=K[M];L.appendChild(N)}if(window.location.search){let O=new URLSearchParams(window.location.search);let P=O.get("clique_id");if(P){P="C"+P;document.getElementById("clique_id").value=`Clique ID: ${P.replace("C","")}`;l.click()}let Q=O.get("gene_id");if(Q){document.getElementById("gene_id").value=Q;m.click()}if(!P&&!Q)n(["C160"])}else{n(["C160"])}});let k=document.getElementById("search_results");let l=document.getElementById("search_button");l.addEventListener("click",function(){f.innerHTML="";let R=document.getElementById("clique_id").value;R="C"+R.split("Clique ID: ")[1];if(!R||!c(R.replace("C",""))){g.innerHTML="Please enter a valid Clique ID between 1 and 281.";return}if(parseInt(R.replace("C",""))>281||parseInt(R.replace("C",""))<1){g.innerHTML="Please enter a valid Clique ID between 1 and 281.";return}k.innerHTML="";g.innerHTML="";window.history.pushState({},"",`?clique_id=${R.replace("C","")}`);n([R])});let m=document.getElementById("gene_search_button");m.addEventListener("click",function(){g.innerHTML="";if(!j){f.innerHTML="Gene to clique data not loaded yet. Please try again.";return}else if(!j[document.getElementById("gene_id").value]){f.innerHTML="Gene not found in any cliques. Please use the dropdown to select valid genes.";return}f.innerHTML="";let S=document.getElementById("gene_id").value;let T=j[S];let U=T.length>1?"cliques":"clique";k.innerHTML=`${S} is a member of ${T.length} ${U}: ${T.join(", ").replace(/C/g,"")}`;if(j[S]){window.history.pushState({},"",`?gene_id=${S}`);n(T,S)}});document.getElementById("clique_id").addEventListener("keyup",function(V){V.preventDefault();if(V.keyCode===13){document.getElementById("search_button").click()}});document.getElementById("gene_id").addEventListener("keyup",function(W){W.preventDefault();if(W.keyCode===13){m.click()}});document.getElementById("clique_id").oninput=function(){let X=document.getElementById("clique_id").value;if(!X.startsWith("Clique ID: ")){document.getElementById("clique_id").value="Clique ID: "}};document.getElementById("clique_id").focus();function n(Y,Z=null){let $=document.getElementById("result_container");$.innerHTML="";for(let _=0;_<Y.length;_++){let aa=document.createElement("div");aa.id=`head_div_${_}`;aa.className="result";if(_!=0)aa.appendChild(document.createElement("hr"));let ba=document.createElement("h3");ba.id=`clique_title_${_}`;ba.style.flex="1";ba.style.height="min-content";ba.style.margin="0pt";ba.style.columnGap="0pt";ba.innerHTML=`Clique ID: ${Y[_].replace("C","")}`;aa.appendChild(ba);let ca=document.createElement("div");ca.id=`result_sub_${_}`;ca.className="result_sub";let da=document.createElement("div");da.id=`info_div_${_}`;da.className="info_div";let ea=document.createElement("h5");ea.className="info_heading";ea.innerHTML="GO Enrichment";let fa=document.createElement("small");fa.className="subtitle";fa.innerHTML="Highest enriched GO terms for clique using over-representation analysis";da.appendChild(ea);da.appendChild(fa);let ga=document.createElement("table");ga.style.marginTop="1em";let ha=document.createElement("thead");let ia=document.createElement("tr");let ja=document.createElement("th");ja.innerHTML="GO Category";let ka=document.createElement("th");ka.innerHTML="Go ID";let la=document.createElement("th");la.innerHTML="Go Term";let ma=document.createElement("th");ma.innerHTML="FDR";ia.appendChild(ja);ia.appendChild(ka);ia.appendChild(la);ia.appendChild(ma);ha.appendChild(ia);let na=document.createElement("tbody");na.id=`table_body_${_}`;ga.appendChild(ha);let oa=Y[_];let pa="dense_modules";let qa=document.createElement("div");qa.style.flexGrow="1";let ra=document.createElement("div");ra.id=`dag_${_}`;ra.className="dag";let sa=document.createElement("p");sa.style.color="var(--color-body-light)";sa.style.fontSize="var(--unit)";sa.style.textAlign="center";sa.innerHTML="Scroll to zoom, click and drag to move nodes.";let ta=document.createElement("button");ta.id=`download_button_${_}`;ta.className="download_button";ta.innerHTML="Download Clique";qa.appendChild(ra);qa.appendChild(sa);qa.appendChild(ta);da.appendChild(ga);ca.appendChild(da);ca.appendChild(qa);aa.appendChild(ca);$.appendChild(aa);fetch(`../data/go/clique/${oa}.json`).then(ua=>ua.json()).then(va=>{na.innerHTML="";let wa=["gobp","gomf","gocc"];let xa={gobp:"Biological Process",gomf:"Molecular Function",gocc:"Cellular Component"};for(let ya=0;ya<wa.length;ya++){let za=wa[ya];let Aa=document.createElement("tr");let Ba=document.createElement("td");let Ca=document.createElement("td");let Da=document.createElement("td");let Ea=document.createElement("td");Ba.innerHTML=xa[za];let Fa=va[za].set;Ca.innerHTML=`<a href="https://amigo.geneontology.org/amigo/term/${Fa}" target="_blank">${Fa}</a>`;Da.innerHTML=va[za].set_name;let Ga=parseFloat(va[za].fdr);Ea.innerHTML=Ga!=0?Ga.toExponential(2):"< 2.20e-16";Aa.appendChild(Ba);Aa.appendChild(Ca);Aa.appendChild(Da);Aa.appendChild(Ea);na.appendChild(Aa)}ga.appendChild(na)}).then(()=>{fetch("../data/table/clique/"+oa+".json").then(Ha=>Ha.json()).then(Ia=>{let Ja=e(Ia["tumor_expression"]);Ja.style.marginTop="1em";let Ka=document.createElement("h5");Ka.className="info_heading";Ka.innerHTML="Tumor Expression";let La=document.createElement("small");La.className="subtitle";La.innerHTML="Tumor expression of genes in the clique";da.appendChild(Ka);da.appendChild(La);da.appendChild(Ja);let Ma=e(Ia["survival"]);Ma.style.marginTop="1em";let Na=document.createElement("h5");Na.className="info_heading";Na.innerHTML="Patient Overall Survival";let Oa=document.createElement("small");Oa.className="subtitle";Oa.innerHTML="Survival analysis of genes in the clique";da.appendChild(Na);da.appendChild(Oa);da.appendChild(Ma)}).then(()=>{dag_chart=create_dag(a,pa,oa,ra.id,ignore_size=true,host="../",scale=1.15);dag_chart.then(Pa=>{let Qa=document.createElement("h5");Qa.className="info_heading";Qa.innerHTML="Clique Members";let Ra=document.createElement("small");Ra.className="subtitle";let Sa=document.createElement("div");let Ta=Pa.getOption().series[0].nodes;let Ua="<p>";for(let Va=0;Va<Ta.length;Va++){let Wa=Ta[Va];Ua+=Wa.name;if(Va!=Ta.length-1){Ua+=", "}}Ua+="</p>";Sa.innerHTML=Ua;Ra.innerHTML=`${Ta.length} members`;da.appendChild(Qa);da.appendChild(Ra);da.appendChild(Sa);window.addEventListener("resize",function(){Pa.resize()});Pa.resize();ta.onclick=function(){b(Pa.getOption().series[0],`clique_${oa.replace("C","")}.json`)};if(Z!=null){Pa.dispatchAction({type:"highlight",seriesIndex:0,name:Z})}})})})}}}