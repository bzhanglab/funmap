function clique_page(a){function b(o,p="clique.json"){const q=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(o))}`;const r=document.createElement("a");r.setAttribute("href",q);r.setAttribute("download",p);document.body.appendChild(r);r.click();r.remove()}function c(s){const t=parseInt(s);return!Number.isNaN(t)&&Number.isFinite(t)}function d(u){return!Number.isNaN(parseFloat(u))&&Number.isFinite(u)}function e(v){const w=document.createElement("table");const x=document.createElement("thead");const y=document.createElement("tbody");const z=document.createElement("tr");for(let A=0;A<v.columns.length;A++){const B=document.createElement("th");const C=v.columns[A];B.innerHTML=C;z.appendChild(B)}x.appendChild(z);w.appendChild(x);for(let D=0;D<v.data.length;D++){const E=document.createElement("tr");for(let F=0;F<v.data[D].length;F++){const G=document.createElement("td");let H=v.data[D][F];if(d(H)){H=parseFloat(H);if(H===0){H="< 2.20e-16"}else if(Math.abs(H)>.001&&Math.abs(H)<1e3){H=H.toPrecision(3)}else{H=H.toExponential(2)}}else if(H==null){H="Not Available"}G.innerHTML=H;E.appendChild(G)}y.appendChild(E)}w.appendChild(y);return w}const f=document.getElementById("gene_search_error");const g=document.getElementById("clique_search_error");const h="../data/clique_genes.json";const i="genes";let j="../data/gene_to_clique.json";fetch(j).then(I=>I.json()).then(J=>{j=J});fetch(h).then(K=>K.json()).then(L=>{const M=document.getElementById(i);for(let N=0;N<L.length;N++){const O=document.createElement("option");O.value=L[N];M.appendChild(O)}if(window.location.search){const P=new URLSearchParams(window.location.search);let Q=P.get("clique_id");if(Q){Q=`C${Q}`;document.getElementById("clique_id").value=`Clique ID: ${Q.replace("C","")}`;l.click()}const R=P.get("gene_id");if(R){document.getElementById("gene_id").value=R;m.click()}if(!Q&&!R)n(["C160"])}else{n(["C160"])}});const k=document.getElementById("search_results");const l=document.getElementById("search_button");l.addEventListener("click",()=>{f.innerHTML="";let S=document.getElementById("clique_id").value;S=`C${S.split("Clique ID: ")[1]}`;if(!S||!c(S.replace("C",""))){g.innerHTML="Please enter a valid Clique ID between 1 and 281.";return}if(parseInt(S.replace("C",""))>281||parseInt(S.replace("C",""))<1){g.innerHTML="Please enter a valid Clique ID between 1 and 281.";return}k.innerHTML="";g.innerHTML="";window.history.pushState({},"",`?clique_id=${S.replace("C","")}`);n([S])});const m=document.getElementById("gene_search_button");m.addEventListener("click",()=>{g.innerHTML="";if(!j){f.innerHTML="Gene to clique data not loaded yet. Please try again.";return}if(!j[document.getElementById("gene_id").value]){f.innerHTML="Gene not found in any cliques. Please use the dropdown to select valid genes.";return}f.innerHTML="";const T=document.getElementById("gene_id").value;const U=j[T];const V=U.length>1?"cliques":"clique";k.innerHTML=`${T} is a member of ${U.length} ${V}: ${U.join(", ").replace(/C/g,"")}`;if(j[T]){window.history.pushState({},"",`?gene_id=${T}`);n(U,T)}});document.getElementById("clique_id").addEventListener("keyup",W=>{W.preventDefault();if(W.keyCode===13||W.key==="Enter"){document.getElementById("search_button").click()}});document.getElementById("gene_id").addEventListener("keyup",X=>{X.preventDefault();if(X.keyCode===13||X.key==="Enter"){m.click()}});document.getElementById("clique_id").oninput=()=>{const Y=document.getElementById("clique_id").value;if(!Y.startsWith("Clique ID: ")){document.getElementById("clique_id").value="Clique ID: "}};document.getElementById("clique_id").focus();function n(Z,$=null){const _=document.getElementById("result_container");_.innerHTML="";for(let aa=0;aa<Z.length;aa++){const ba=document.createElement("div");ba.id=`head_div_${aa}`;ba.className="result";if(aa!==0)ba.appendChild(document.createElement("hr"));const ca=document.createElement("h3");ca.id=`clique_title_${aa}`;ca.style.flex="1";ca.style.height="min-content";ca.style.margin="0pt";ca.style.columnGap="0pt";ca.innerHTML=`Clique ID: ${Z[aa].replace("C","")}`;ba.appendChild(ca);const da=document.createElement("div");da.id=`result_sub_${aa}`;da.className="result_sub";const ea=document.createElement("div");ea.id=`info_div_${aa}`;ea.className="info_div";const fa=document.createElement("h5");fa.className="info_heading";fa.innerHTML="GO Enrichment";const ga=document.createElement("small");ga.className="subtitle";ga.innerHTML="Top enriched GO terms for clique using over-representation analysis";ea.appendChild(fa);ea.appendChild(ga);const ha=document.createElement("table");ha.style.marginTop="1em";const ia=document.createElement("thead");const ja=document.createElement("tr");const ka=document.createElement("th");ka.innerHTML="GO Category";const la=document.createElement("th");la.innerHTML="Go ID";const ma=document.createElement("th");ma.innerHTML="Go Term";const na=document.createElement("th");na.innerHTML="<i>p</i>-Value";na.style.whiteSpace="nowrap";const oa=document.createElement("th");oa.innerHTML="FDR";ja.appendChild(ka);ja.appendChild(la);ja.appendChild(ma);ja.appendChild(na);ja.appendChild(oa);ia.appendChild(ja);const pa=document.createElement("tbody");pa.id=`table_body_${aa}`;ha.appendChild(ia);ha.className="long_table";const qa=Z[aa];const ra="dense_modules";const sa=document.createElement("div");sa.style.flexGrow="1";const ta=document.createElement("div");ta.id=`dag_${aa}`;ta.className="dag";const ua=document.createElement("p");ua.style.color="var(--color-body-light)";ua.style.fontSize="var(--unit)";ua.style.textAlign="center";ua.innerHTML="Gene significance across 5 cohorts (signed -log<sub>10</sub> meta-<i>p</i>).<br>Scroll to zoom, click and drag to move nodes.";sa.appendChild(ta);sa.appendChild(ua);ea.appendChild(ha);da.appendChild(ea);da.appendChild(sa);ba.appendChild(da);_.appendChild(ba);fetch(`../data/go/clique/${qa}.json`).then(va=>va.json()).then(wa=>{pa.innerHTML="";const xa=["gobp","gomf","gocc"];const ya={gobp:"Biological Process",gomf:"Molecular Function",gocc:"Cellular Component"};for(let za=0;za<xa.length;za++){const Aa=xa[za];const Ba=document.createElement("tr");const Ca=document.createElement("td");const Da=document.createElement("td");const Ea=document.createElement("td");const Fa=document.createElement("td");const Ga=document.createElement("td");Ca.innerHTML=ya[Aa];const Ha=wa[Aa].set;Da.innerHTML=`<a href="https://amigo.geneontology.org/amigo/term/${Ha}" target="_blank">${Ha}</a>`;Ea.innerHTML=wa[Aa].set_name;const Ia=parseFloat(wa[Aa].p);Fa.innerHTML=Ia!==0?Ia.toExponential(2):"< 2.20e-16";const Ja=parseFloat(wa[Aa].fdr);Ga.innerHTML=Ja!==0?Ja.toExponential(2):"< 2.20e-16";Ba.appendChild(Ca);Ba.appendChild(Da);Ba.appendChild(Ea);Ba.appendChild(Fa);Ba.appendChild(Ga);pa.appendChild(Ba)}ha.appendChild(pa)}).then(()=>{fetch(`../data/table/clique/${qa}.json`).then(Ka=>Ka.json()).then(La=>{const Ma=e(La.tumor_expression);Ma.style.marginTop="1em";const Na=document.createElement("h5");Na.className="info_heading";Na.innerHTML="Tumor Expression by Cohort";const Oa=document.createElement("small");Oa.className="subtitle";Oa.innerHTML="The <i>p</i>-values were derived from difference in average protein abundance of clique genes between tumor and normal samples by Wilcoxon rank-sum test.";ea.appendChild(Na);ea.appendChild(Oa);ea.appendChild(Ma);const Pa=e(La.survival);Pa.style.marginTop="1em";const Qa=document.createElement("h5");Qa.className="info_heading";Qa.innerHTML="Patient Overall Survival by Cohort";const Ra=document.createElement("small");Ra.className="subtitle";Ra.innerHTML="Logrank <i>p</i>-values were derived from Cox-proportional hazard models using average protein abundance of clique genes stratified by median.";ea.appendChild(Qa);ea.appendChild(Ra);ea.appendChild(Pa)}).then(()=>{dag_chart=create_dag(a,ra,qa,ta.id,true,"../",1.15);dag_chart.then(Sa=>{const Ta=document.createElement("h5");Ta.className="info_heading";Ta.innerHTML="Clique Members";const Ua=document.createElement("small");Ua.className="subtitle";const Va=document.createElement("div");const Wa=Sa.getOption().series[0].nodes;let Xa="<p>";for(let Ya=0;Ya<Wa.length;Ya++){const Za=Wa[Ya];Xa+=Za.name;if(Ya!==Wa.length-1){Xa+=", "}}Xa+="</p>";Va.innerHTML=Xa;Ua.innerHTML=`${Wa.length} members`;sa.appendChild(Ta);sa.appendChild(Ua);sa.appendChild(Va);window.addEventListener("resize",()=>{Sa.resize()});Sa.resize();if($!=null){Sa.dispatchAction({type:"highlight",seriesIndex:0,name:$})}})})})}}}