function clique_page(a){function b(o,p="clique.json"){const q=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(o))}`;const r=document.createElement("a");r.setAttribute("href",q);r.setAttribute("download",p);document.body.appendChild(r);r.click();r.remove()}function c(s){const t=parseInt(s);return!Number.isNaN(t)&&Number.isFinite(t)}function d(u){const v=parseFloat(u);return!Number.isNaN(v)&&Number.isFinite(v)}function e(w){const x=document.createElement("table");const y=document.createElement("thead");const z=document.createElement("tbody");const A=document.createElement("tr");for(let B=0;B<w.columns.length;B++){const C=document.createElement("th");const D=w.columns[B];C.innerHTML=D;A.appendChild(C)}y.appendChild(A);x.appendChild(y);for(let E=0;E<w.data.length;E++){const F=document.createElement("tr");for(let G=0;G<w.data[E].length;G++){const H=document.createElement("td");let I=w.data[E][G];if(d(I)){I=parseFloat(I);if(I===0){I="< 2.20e-16"}else if(Math.abs(I)>.001&&Math.abs(I)<1e3){I=I.toPrecision(3)}else{I=I.toExponential(2)}}else if(I==null){I="Not Available"}H.innerHTML=I;F.appendChild(H)}z.appendChild(F)}x.appendChild(z);return x}const f=document.getElementById("gene_search_error");const g=document.getElementById("clique_search_error");const h="../data/clique_genes.json";const i="genes";let j="../data/gene_to_clique.json";fetch(j).then(J=>J.json()).then(K=>{j=K});fetch(h).then(L=>L.json()).then(M=>{const N=document.getElementById(i);for(let O=0;O<M.length;O++){const P=document.createElement("option");P.value=M[O];N.appendChild(P)}if(window.location.search){const Q=new URLSearchParams(window.location.search);let R=Q.get("clique_id");if(R){R=`C${R}`;document.getElementById("clique_id").value=`Clique ID: ${R.replace("C","")}`;l.click()}const S=Q.get("gene_id");if(S){document.getElementById("gene_id").value=S;m.click()}if(!R&&!S)n(["C160"])}else{n(["C160"])}});const k=document.getElementById("search_results");const l=document.getElementById("search_button");l.addEventListener("click",()=>{f.innerHTML="";let T=document.getElementById("clique_id").value;T=`C${T.split("Clique ID: ")[1]}`;if(!T||!c(T.replace("C",""))){g.innerHTML="Please enter a valid Clique ID between 1 and 281.";return}if(parseInt(T.replace("C",""))>281||parseInt(T.replace("C",""))<1){g.innerHTML="Please enter a valid Clique ID between 1 and 281.";return}k.innerHTML="";g.innerHTML="";window.history.pushState({},"",`?clique_id=${T.replace("C","")}`);n([T])});const m=document.getElementById("gene_search_button");m.addEventListener("click",()=>{g.innerHTML="";if(!j){f.innerHTML="Gene to clique data not loaded yet. Please try again.";return}if(!j[document.getElementById("gene_id").value]){f.innerHTML="Gene not found in any cliques. Please use the dropdown to select valid genes.";return}f.innerHTML="";const U=document.getElementById("gene_id").value;const V=j[U];const W=V.length>1?"cliques":"clique";k.innerHTML=`${U} is a member of ${V.length} ${W}: ${V.join(", ").replace(/C/g,"")}`;if(j[U]){window.history.pushState({},"",`?gene_id=${U}`);n(V,U)}});document.getElementById("clique_id").addEventListener("keyup",X=>{X.preventDefault();if(X.keyCode===13||X.key==="Enter"){document.getElementById("search_button").click()}});document.getElementById("gene_id").addEventListener("keyup",Y=>{Y.preventDefault();if(Y.keyCode===13||Y.key==="Enter"){m.click()}});document.getElementById("clique_id").oninput=()=>{const Z=document.getElementById("clique_id").value;if(!Z.startsWith("Clique ID: ")){document.getElementById("clique_id").value="Clique ID: "}};document.getElementById("clique_id").focus();function n($,_=null){const aa=document.getElementById("result_container");aa.innerHTML="";for(let ba=0;ba<$.length;ba++){const ca=document.createElement("div");ca.id=`head_div_${ba}`;ca.className="result";if(ba!==0)ca.appendChild(document.createElement("hr"));const da=document.createElement("h3");da.id=`clique_title_${ba}`;da.style.flex="1";da.style.height="min-content";da.style.margin="0pt";da.style.columnGap="0pt";da.innerHTML=`Clique ID: ${$[ba].replace("C","")}`;ca.appendChild(da);const ea=document.createElement("div");ea.id=`result_sub_${ba}`;ea.className="result_sub";const fa=document.createElement("div");fa.id=`info_div_${ba}`;fa.className="info_div";const ga=document.createElement("h5");ga.className="info_heading";ga.innerHTML="GO Enrichment";const ha=document.createElement("small");ha.className="subtitle";ha.innerHTML="Top enriched GO terms for clique using over-representation analysis";fa.appendChild(ga);fa.appendChild(ha);const ia=document.createElement("table");ia.style.marginTop="1em";const ja=document.createElement("thead");const ka=document.createElement("tr");const la=document.createElement("th");la.innerHTML="GO Category";const ma=document.createElement("th");ma.innerHTML="Go ID";const na=document.createElement("th");na.innerHTML="Go Term";const oa=document.createElement("th");oa.innerHTML="<i>p</i>-Value";oa.style.whiteSpace="nowrap";const pa=document.createElement("th");pa.innerHTML="FDR";ka.appendChild(la);ka.appendChild(ma);ka.appendChild(na);ka.appendChild(oa);ka.appendChild(pa);ja.appendChild(ka);const qa=document.createElement("tbody");qa.id=`table_body_${ba}`;ia.appendChild(ja);ia.className="long_table";const ra=$[ba];const sa="dense_modules";const ta=document.createElement("div");ta.style.flexGrow="1";const ua=document.createElement("div");ua.id=`dag_${ba}`;ua.className="dag";const va=document.createElement("p");va.style.color="var(--color-body-light)";va.style.fontSize="var(--unit)";va.style.textAlign="center";va.innerHTML="Gene significance across 5 cohorts (signed -log<sub>10</sub> meta-<i>p</i>).<br>Scroll to zoom, click and drag to move nodes.";ta.appendChild(ua);ta.appendChild(va);fa.appendChild(ia);ea.appendChild(fa);ea.appendChild(ta);ca.appendChild(ea);aa.appendChild(ca);fetch(`../data/go/clique/${ra}.json`).then(wa=>wa.json()).then(xa=>{qa.innerHTML="";const ya=["gobp","gomf","gocc"];const za={gobp:"Biological Process",gomf:"Molecular Function",gocc:"Cellular Component"};for(let Aa=0;Aa<ya.length;Aa++){const Ba=ya[Aa];const Ca=document.createElement("tr");const Da=document.createElement("td");const Ea=document.createElement("td");const Fa=document.createElement("td");const Ga=document.createElement("td");const Ha=document.createElement("td");Da.innerHTML=za[Ba];const Ia=xa[Ba].set;Ea.innerHTML=`<a href="https://amigo.geneontology.org/amigo/term/${Ia}" target="_blank">${Ia}</a>`;Fa.innerHTML=xa[Ba].set_name;const Ja=parseFloat(xa[Ba].p);Ga.innerHTML=Ja!==0?Ja.toExponential(2):"< 2.20e-16";const Ka=parseFloat(xa[Ba].fdr);Ha.innerHTML=Ka!==0?Ka.toExponential(2):"< 2.20e-16";Ca.appendChild(Da);Ca.appendChild(Ea);Ca.appendChild(Fa);Ca.appendChild(Ga);Ca.appendChild(Ha);qa.appendChild(Ca)}ia.appendChild(qa)}).then(()=>{fetch(`../data/table/clique/${ra}.json`).then(La=>La.json()).then(Ma=>{const Na=e(Ma.tumor_expression);Na.style.marginTop="1em";const Oa=document.createElement("h5");Oa.className="info_heading";Oa.innerHTML="Tumor Expression by Cohort";const Pa=document.createElement("small");Pa.className="subtitle";Pa.innerHTML="The <i>p</i>-values were derived from difference in average protein abundance of clique genes between tumor and normal samples by Wilcoxon rank-sum test.";fa.appendChild(Oa);fa.appendChild(Pa);fa.appendChild(Na);const Qa=e(Ma.survival);Qa.style.marginTop="1em";const Ra=document.createElement("h5");Ra.className="info_heading";Ra.innerHTML="Patient Overall Survival by Cohort";const Sa=document.createElement("small");Sa.className="subtitle";Sa.innerHTML="Logrank <i>p</i>-values were derived from Cox-proportional hazard models using average protein abundance of clique genes stratified by median.";fa.appendChild(Ra);fa.appendChild(Sa);fa.appendChild(Qa)}).then(()=>{dag_chart=create_dag(a,sa,ra,ua.id,true,"../",1.15);dag_chart.then(Ta=>{const Ua=document.createElement("h5");Ua.className="info_heading";Ua.innerHTML="Clique Members";const Va=document.createElement("small");Va.className="subtitle";const Wa=document.createElement("div");const Xa=Ta.getOption().series[0].nodes;let Ya="<p>";for(let Za=0;Za<Xa.length;Za++){const $a=Xa[Za];Ya+=$a.name;if(Za!==Xa.length-1){Ya+=", "}}Ya+="</p>";Wa.innerHTML=Ya;Va.innerHTML=`${Xa.length} members`;ta.appendChild(Ua);ta.appendChild(Va);ta.appendChild(Wa);window.addEventListener("resize",()=>{Ta.resize()});Ta.resize();if(_!=null){Ta.dispatchAction({type:"highlight",seriesIndex:0,name:_})}})})})}}}